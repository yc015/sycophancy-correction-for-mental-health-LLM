# Detecting and Correcting Sycophancy in Talk Therapist Chatbot

Team: [Yida Chen](https://yc015.github.io/), [Catherine Yeh](https://catherinesyeh.github.io/), [Jerry Huang](https://www.linkedin.com/in/jerryh01?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAB_tAjoB0RDPcPJKWNv_-Wd1_rmtxuEfGdM&lipi=urn%3Ali%3Apage%3Ad_flagship3_search_srp_people%3BpiizAGN6Tl%2BJDLTjDSUu6g%3D%3D)

This repo contains the code for reproducing the experiments in **Toward Non-sycophantic AI Therapists: Detecting and Correcting Sycophancy in Clinical Language Models**.

## Content
[data_exploration.ipynb](https://github.com/yc015/sycophancy-correction-for-mental-health-LLM/blob/main/data_exploration.ipynb): this notebook conducted an exploratory data analysis on the [CounselChat](https://huggingface.co/datasets/nbertagnolli/counsel-chat) dataset.  
[autogenerate_sycophantic_answers](https://github.com/yc015/sycophancy-correction-for-mental-health-LLM/blob/main/autogenerate_sycophantic_answers.ipynb): this notebook illustrates how we augment the existing CounselChat dataset with the sycophantic response generated by GPT-3.5 model.  
[Sycophancy_Detector.ipynb](https://github.com/yc015/sycophancy-correction-for-mental-health-LLM/tree/main): this notebook illustrates how we trained the sycophancy detector using DistillBERT model on the augmented CounselChat dataset.  
[generate_response_llama2.ipynb](https://github.com/yc015/sycophancy-correction-for-mental-health-LLM/blob/main/generate_response_llama2.ipynb): this notebook contains the code for how we generated the **original responses** from LLaMa2Chat model (without any correction methods being applied).  
[cfg_generate_response_llama2.ipynb](https://github.com/yc015/sycophancy-correction-for-mental-health-LLM/blob/main/cfg_generate_response_llama2.ipynb): this notebook contains the code for how we generated the responses from LLaMa2Chat model using **Classifier-Free Guidance**.  
[contrast_decoding_generate_response_llama2.ipynb](https://github.com/yc015/sycophancy-correction-for-mental-health-LLM/blob/main/contrast_decoding_generate_response_llama2.ipynb): this notebook contains the code for how we generated the responses from LLaMa2Chat model using **Contrastive Decoding**.  
[activation_editing_generate_response_llama2.ipynb](https://github.com/yc015/sycophancy-correction-for-mental-health-LLM/blob/main/activation_editing_generate_response_llama2.ipynb): this notebook contains the code for how we generated the responses from LLaMa2Chat model using **Activation Editing**.  
[internal_model_of_sycophancy.ipynb](https://github.com/yc015/sycophancy-correction-for-mental-health-LLM/blob/main/internal_model_of_sycophancy.ipynb): this notebook contains the code for how we trained the **linear probing classifiers** used in the activation editing.  

## Performance of Correction Method
